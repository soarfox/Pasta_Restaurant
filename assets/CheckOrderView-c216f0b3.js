import{p as i}from"./productsStore-d4257f7a.js";import{_ as F,m as x,u as k,a as h,r as d,o as s,c as r,b as t,F as b,f as y,t as o,d as V,w as S,e as c,j as f}from"./index-07f37587.js";const v={data(){return{loading:!1,formData:{user:{name:"",email:"",tel:"",address:""},message:""},formFields:[{id:"name",label:"收件人姓名",type:"text",placeholder:"請輸入完整姓名",rule:"required"},{id:"email",label:"收件人Email",type:"email",placeholder:"請輸入Email",rule:"required|email"},{id:"tel",label:"收件人手機號碼",type:"tel",placeholder:"請輸入手機號碼",rule:"required|digits:10"},{id:"address",label:"收件地址",type:"text",placeholder:"請輸入完整地址",rule:"required"},{id:"message",label:"附註",type:"textarea",placeholder:"如有任何需求，歡迎填寫"}]}},methods:{...x(i,["postCartItemsToOrder"]),async submitForm(){this.loading=!0;const l=k();await this.postCartItemsToOrder(this.formData),this.orderResult!==void 0?(l.success("訂單已成立！"),this.$router.push({path:"payment"})):l.error("加入訂單時發生錯誤!"),this.loading=!1}},computed:{...h(i,["itemsInCart"]),...h(i,["orderResult"]),totalPrice(){return!this.itemsInCart||!this.itemsInCart.carts?0:this.itemsInCart.carts.reduce((u,m)=>u+m.final_total,0)}}},D=t("ul",{class:"steps"},[t("li",{class:"current-step"},[c("Step1. "),t("span",null,"建立訂單")]),t("li",null,[c("Step2. "),t("span",null,"確認付款")]),t("li",null,[c("Step3. "),t("span",null,"完成訂購")])],-1),I={class:"cart-form"},q={class:"cart-list"},T=t("div",{class:"title"},"訂單明細",-1),E={class:"order"},N={class:"product-img"},P=["src"],U={class:"product-name"},w={class:"product-quantity"},B={class:"product-price"},O={class:"tfoot"},M={class:"totalPrice"},R=t("td",null,"總計",-1),j={class:"title"},A=["disabled"];function L(l,u,m,z,a,p){const _=d("VField"),g=d("ErrorMessage"),C=d("VForm");return s(),r("main",null,[D,t("div",I,[t("div",q,[T,t("table",E,[t("tbody",null,[(s(!0),r(b,null,y(l.itemsInCart.carts,e=>(s(),r("tr",{key:e.id},[t("td",N,[t("img",{src:e.product.imageUrl,alt:""},null,8,P)]),t("td",U,o(e.product.title),1),t("td",w,"數量："+o(e.qty),1),t("td",B,"NT$ "+o(e.final_total),1)]))),128))]),t("tfoot",O,[t("tr",M,[R,t("td",null,"NT$ "+o(p.totalPrice),1)])])])]),V(C,{class:"form",onSubmit:p.submitForm},{default:S(()=>[(s(!0),r(b,null,y(a.formFields,e=>(s(),r("div",{class:"fields",key:e.id},[t("label",j,o(e.label),1),e.type==="textarea"?(s(),f(_,{key:0,class:"textarea",modelValue:a.formData[e.id],"onUpdate:modelValue":n=>a.formData[e.id]=n,rules:e.rule,as:e.type,name:e.id,id:e.id,placeholder:e.placeholder},null,8,["modelValue","onUpdate:modelValue","rules","as","name","id","placeholder"])):(s(),f(_,{key:1,class:"input-field",modelValue:a.formData.user[e.id],"onUpdate:modelValue":n=>a.formData.user[e.id]=n,rules:e.rule,type:e.type,name:e.id,id:e.id,placeholder:e.placeholder},null,8,["modelValue","onUpdate:modelValue","rules","type","name","id","placeholder"])),V(g,{class:"validation",name:e.id},null,8,["name"])]))),128)),t("input",{class:"button-submit",name:"button-submit",type:"submit",value:"送出訂單",disabled:a.loading},null,8,A)]),_:1},8,["onSubmit"])])])}const J=F(v,[["render",L]]);export{J as default};
